apiVersion: v1
kind: Secret
metadata:
  name: {{ include "filesender.fullname" . }}
  labels:
    {{- include "filesender.labels" . | nindent 4 }}
type: Opaque
stringData:
  # SimpleSAMLphp secrets
  simplesamlphp-admin-password: {{ .Values.simplesamlphp.adminPassword | default (randAlphaNum 32) | quote }}
  simplesamlphp-secret-salt: {{ .Values.simplesamlphp.secretSalt | default (randAlphaNum 64) | quote }}
  
  {{- if .Values.simplesamlphp.localUsers.enabled }}
  # Local user passwords
  {{- range .Values.simplesamlphp.localUsers.users }}
  local-user-{{ .username }}-password: {{ .password | default (randAlphaNum 16) | quote }}
  {{- end }}
  {{- end }}
  
  # PostgreSQL password (for internal database)
  {{- if .Values.postgresql.internal.enabled }}
  postgres-password: {{ .Values.postgresql.internal.password | default (randAlphaNum 32) | quote }}
  {{- end }}
  
  # PostgreSQL password (for external database)
  {{- if and .Values.postgresql.external.enabled (not .Values.postgresql.external.existingSecret) }}
  postgres-external-password: {{ .Values.postgresql.external.password | quote }}
  {{- end }}
